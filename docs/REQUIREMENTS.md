# RAMMS Avalanche Viewer

## Project Overview

A web application to visualize avalanche simulations created with [RAMMS::AVALANCHE](https://ramms.ch/ramms-avalanche/). The application will display 3D animated avalanche flow data and allow users to navigate between multiple simulation datasets.

### Existing Resources

- **`./data/`** – Contains 4 raster datasets generated by RAMMS::AVALANCHE
- **`./prototype/`** – Working JavaScript prototype that visualizes a single avalanche simulation

---

## Technical Stack

| Component   | Technology                                                                 | Version |
|-------------|----------------------------------------------------------------------------|---------|
| 3D Engine   | [ArcGIS Maps SDK for JavaScript](https://developers.arcgis.com/javascript/latest/) | 4.34    |
| Language    | TypeScript                                                                 | Latest  |
| UI Library  | [Calcite Design System](https://developers.arcgis.com/calcite-design-system/) | 3.0     |

---

## Tasks

### Phase 1: Project Setup

1. Create a TypeScript bootstrap project with ArcGIS Maps SDK and Calcite Design System
2. Port the existing prototype to the new project structure with typescript and calcite components
3. **Manual Review Checkpoint** – Test the application before proceeding

### Phase 2: CI/CD

4. Create a GitHub Action workflow:
   - Trigger on every commit to `main`
   - Build the project
   - Deploy to GitHub Pages

### Phase 3: Multi-Avalanche Support

5. Create a JSON configuration file in the data folder to define available avalanche datasets
6. Implement a navigation menu to:
   - List all configured avalanches
   - Switch between avalanches with automatic zoom-to-extent
   - Start individual simulations

### Phase 4: Enhancements

7. Add "Play All" feature:
   - Start all avalanche simulations simultaneously
   - Zoom to combined extent of all avalanches

---

## Data Model

Configuration file: `data/avalanches.json`
```json
{
  "avalanches": [
    {
      "id": "unique-identifier",
      "title": "Avalanche Display Name",
      "folderPath": "relative/path/to/raster/data",
      "rootName": "base_filename",
      "timeResolution": 1.0,
      "releaseAreaFile": "release_area.tif"
    }
  ]
}
```

| Field             | Type   | Description                                      |
|-------------------|--------|--------------------------------------------------|
| `id`              | string | Unique identifier for the avalanche              |
| `title`           | string | Human-readable name for the menu                 |
| `folderPath`      | string | Relative path to the folder containing rasters   |
| `rootName`        | string | Base filename prefix for the raster sequence     |
| `timeResolution`  | number | Time step between frames (in seconds)            |
| `releaseAreaFile` | string | Filename of the release area raster              |

---

## Open Questions

1. **Static Assets Location** – Should data files be placed in `public/` for inclusion in the build output? *(Recommendation: Yes, use `public/data/` so files are copied as-is during build)*

2. **Supported Raster Formats** – Which formats need to be supported? (GeoTIFF, ASCII Grid, etc.)

3. **Playback Controls** – Should individual avalanche simulations have play/pause/speed controls?

4. **Initial View** – On app load, should it show a default avalanche or an overview of all locations?

---

## Acceptance Criteria

- [ ] App builds without errors in TypeScript
- [ ] Prototype functionality fully preserved
- [ ] GitHub Pages deployment works automatically
- [ ] Menu lists all configured avalanches from JSON
- [ ] Clicking an avalanche zooms to its extent and starts playback
- [ ] "Play All" starts all simulations with combined view